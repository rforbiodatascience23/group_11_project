```{r}
#| label: Loading libraries

library("tidyverse")
library("patchwork") #for plotting plots together (plo1/plot2)
library("ggridges")
#library("viridis")
library("dplyr")
library("table1") #describing a cohort
library("stringr") #count the number of occurrences of a given character in a string
library("ggseqlogo") #to create sequence logos
library("readr")
```

```{r}
#| label: Renaming rx column, converting to numeric, replacing NAs 
prostate_data_clean <- prostate_data |>
  separate("rx", into = c("Treatment regime", "mg","Drug"), sep =" ") |>
  select(-c("mg"))


prostate_data_clean <- prostate_data_clean |>
  mutate(`Treatment regime` = case_when(
    `Treatment regime` == "placebo" ~ "0",
    TRUE ~ as.character(`Treatment regime`))) |>
  mutate(`Treatment regime` = as.numeric(`Treatment regime`))
 
prostate_data_clean <- prostate_data_clean |>
  mutate(`Drug` = case_when(
    `Drug` == "estrogen" ~ "1",
    TRUE ~ as.character(`Drug`))) |>
  mutate(`Drug` = as.numeric(`Drug`)) |>
  mutate(`Drug` = replace_na(`Drug`,0))

```

```{r}
#| label: Modifying Status column, creating new columns, converting str to numeric

prostate_data_clean <- prostate_data_clean |>
  separate("status", into = c("Status", "Cause of Death"), sep ="\\-")

prostate_data_clean <- prostate_data_clean |>
  mutate(`Status` = case_when(
    `Status` == "alive" ~ "1",
    TRUE ~ as.character(`Status`))) |>
  mutate(`Status` = as.numeric(`Status`)) |>
  mutate(`Status` = replace_na(`Status`,0))
```

```{r}
#| label: Modifying PF column

prostate_data_clean <- prostate_data_clean |>
  mutate(`pf` = if_else(
    `pf` == "normal activity", 0,
    1))
  
```

```{r}
#|label: Save data

output_file_path <- "../data/02_dat_clean.tsv"
write_delim( prostate_data_clean, file = output_file_path )
```


